#!/usr/local/bin/bash

# shellcheck disable=SC2155
export EMACS_SOCKET_NAME="${TMPDIR}emacs$(id -u)/server"
export EDITOR="$(which emacsclient) --tty"

alias emacs-save="emacsclient --eval '(save-some-buffers t)' >/dev/null"
alias emacs-kill="emacsclient --eval '(kill-emacs)' >/dev/null"
alias save-emacs=emacs-save
alias kill-emacs=emacs-kill
alias give-emacs=emacs-give
alias gib=emacs-give

function emacs {
    if [ $# -eq 0 ]; then
        $EDITOR
    else
        $EDITOR --eval "(let ((file (car server-eval-args-left)))(mapc #'find-file-noselect server-eval-args-left)(setq server-eval-args-left nil)(find-file file))" -- "$@"
    fi
}

function emacs-give {
    if [ $# -eq 0 ]; then
        return 0
    fi
    emacsclient --eval "(let ((files server-eval-args-left)) (setq server-eval-args-left nil) (mapc #'find-file-noselect files))" -- "$@" >/dev/null
}
